<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AIIMS CRE Radiographer - Review Mode</title>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #1e40af;
            --bg: #f1f5f9;
            --text: #0f172a;
            --success: #10b981;
            --success-light: #dcfce7;
            --danger: #ef4444;
            --danger-light: #fee2e2;
            --warning: #f59e0b;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding-bottom: 100px;
        }

        .container { max-width: 800px; margin: 0 auto; padding: 15px; }

        /* HEADER */
        header {
            background: white;
            padding: 12px 16px;
            position: sticky; top: 0; z-index: 100;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
        }
        .header-title h1 { margin: 0; font-size: 1.1rem; color: var(--secondary); }
        .counter-badge { background: var(--secondary); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; }

        /* QUESTION CARDS */
        .question-card {
            background: white; padding: 20px; border-radius: 12px; margin-top: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05); border: 1px solid #e2e8f0;
        }
        .q-header { display: flex; gap: 10px; margin-bottom: 15px; }
        .q-num { background: #e0e7ff; color: var(--secondary); font-weight: bold; padding: 2px 8px; border-radius: 6px; height: fit-content; }
        .q-text { font-weight: 600; font-size: 1.05rem; line-height: 1.5; }

        .options-list { display: flex; flex-direction: column; gap: 8px; }
        .option-item {
            display: flex; padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px;
            cursor: pointer; align-items: flex-start; transition: all 0.2s; background: #fff;
        }
        .option-item.selected { border-color: var(--primary); background-color: #eff6ff; box-shadow: 0 0 0 1px var(--primary); }
        .opt-text { font-size: 0.95rem; line-height: 1.4; margin-left: 8px; }

        /* REVIEW MODE STYLES */
        .review-correct { border-color: var(--success); background-color: var(--success-light); color: #064e3b; }
        .review-wrong { border-color: var(--danger); background-color: var(--danger-light); color: #7f1d1d; }
        .explanation-box {
            margin-top: 15px; padding: 15px; background: #f8fafc; border-left: 4px solid var(--secondary);
            border-radius: 4px; font-size: 0.9rem; color: #334155; display: none;
        }
        .explanation-box strong { color: var(--secondary); display: block; margin-bottom: 5px; }

        /* BUTTONS */
        .fab-submit {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: var(--secondary); color: white; padding: 16px 32px; border-radius: 50px;
            font-weight: bold; font-size: 1.1rem; border: none; box-shadow: 0 10px 15px rgba(0,0,0,0.2);
            z-index: 90; width: 90%; max-width: 400px; cursor: pointer;
        }

        /* MODAL */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8); z-index: 200; align-items: center; justify-content: center; padding: 20px;
        }
        .modal-card { background: white; width: 100%; max-width: 400px; border-radius: 16px; padding: 24px; text-align: center; }
        .score-big { font-size: 3.5rem; font-weight: 800; color: var(--primary); margin: 10px 0; line-height: 1; }
        .grid-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 24px 0; }
        .stat-item { background: #f1f5f9; padding: 12px; border-radius: 8px; }
        .stat-val { font-size: 1.25rem; font-weight: bold; }
        .stat-lbl { font-size: 0.75rem; text-transform: uppercase; color: #64748b; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        .btn-review { flex: 1; background: var(--primary); color: white; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;}
        .btn-reset { flex: 1; background: #64748b; color: white; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;}

    </style>
</head>
<body>

<header>
    <div class="header-title">
        <h1>AIIMS Mock & Review</h1>
        <div style="font-size:0.75rem; color:#666">Max: 400 | +4, -1</div>
    </div>
    <div class="counter-badge" id="status-badge">
        <span id="attempted-count">0</span> / 100
    </div>
</header>

<div class="container" id="quiz-list">
    </div>

<button class="fab-submit" id="main-action-btn" onclick="submitExam()">Submit Exam</button>

<div class="modal-overlay" id="result-modal">
    <div class="modal-card">
        <h2 style="margin:0; color:#334155;">Result Analysis</h2>
        <div class="score-big" id="final-score">0</div>
        <div style="color:#64748b; font-size:0.9rem;">/ 400 Marks</div>

        <div class="grid-stats">
            <div class="stat-item" style="border-bottom: 3px solid var(--success)">
                <div class="stat-val" id="res-correct" style="color:var(--success)">0</div>
                <div class="stat-lbl">Correct</div>
            </div>
            <div class="stat-item" style="border-bottom: 3px solid var(--danger)">
                <div class="stat-val" id="res-incorrect" style="color:var(--danger)">0</div>
                <div class="stat-lbl">Incorrect</div>
            </div>
            <div class="stat-item" style="border-bottom: 3px solid var(--warning)">
                <div class="stat-val" id="res-skipped">0</div>
                <div class="stat-lbl">Skipped</div>
            </div>
            <div class="stat-item" style="border-bottom: 3px solid var(--primary)">
                <div class="stat-val" id="res-accuracy">0%</div>
                <div class="stat-lbl">Accuracy</div>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn-review" onclick="startReviewMode()">Review Paper</button>
            <button class="btn-reset" onclick="resetExam()">Close & Reset</button>
        </div>
    </div>
</div>

<script>
    // --- 100 QUESTION DATABASE WITH EXPLANATIONS ---
const questionsDB = [
    // --- PHYSICS & EQUIPMENT ---
    { id: 1, q: "The 'Anode Heel Effect' is most pronounced when using:", options: ["Large film size and short SID", "Small film size and long SID", "Large film size and long SID", "Small film size and short SID"], correct: 0, explanation: "The heel effect is more noticeable when the X-ray beam must diverge more (short SID) to cover a large area (large film size)." },
    { id: 2, q: "Which interaction is primarily responsible for radiographic contrast in the diagnostic range?", options: ["Photoelectric Effect", "Compton Scattering", "Pair Production", "Coherent Scattering"], correct: 0, explanation: "The Photoelectric effect depends on the atomic number (Z) of tissues, creating the black-and-white contrast between bone and soft tissue." },
    { id: 3, q: "The focusing cup in the X-ray tube is negatively charged to:", options: ["Attract electrons", "Condense the electron beam", "Accelerate electrons", "Cool the filament"], correct: 1, explanation: "The negative charge repels the electrons, keeping them focused in a tight stream directed toward the focal spot." },
    { id: 4, q: "Total filtration required for X-ray equipment operating above 70 kVp is:", options: ["1.5 mm Al", "2.5 mm Al", "0.5 mm Al", "4.0 mm Al"], correct: 1, explanation: "NCRP guidelines mandate a minimum of 2.5 mm Aluminum equivalent filtration for tubes operating above 70 kVp to reduce patient skin dose." },
    { id: 5, q: "The 'Line Focus Principle' causes the effective focal spot to be:", options: ["Larger than the actual focal spot", "Smaller than the actual focal spot", "Equal to the actual focal spot", "Circular in shape"], correct: 1, explanation: "Angling the anode allows for a large actual focal spot (for heat dissipation) while maintaining a small effective focal spot (for image detail)." },
    { id: 6, q: "Which component of the induction motor is located outside the glass envelope?", options: ["Rotor", "Stator", "Bearings", "Anode Stem"], correct: 1, explanation: "The Stator consists of electromagnets located outside the vacuum envelope that induce rotation in the internal Rotor." },
    { id: 7, q: "The primary purpose of a grid is to:", options: ["Reduce patient dose", "Increase radiographic density", "Improve image contrast", "Reduce exposure time"], correct: 2, explanation: "Grids absorb scattered radiation before it reaches the film, significantly improving image contrast." },
    { id: 8, q: "A grid ratio of 12:1 means:", options: ["The lead strips are 12 times wider than the interspace", "The height of the lead strips is 12 times the width of the interspace", "The grid frequency is 12 lines per cm", "The grid weighs 12 kg"], correct: 1, explanation: "Grid Ratio = Height of lead strips (h) / Width of interspace material (D)." },
    { id: 9, q: "Which rectifier converts AC to DC in modern X-ray circuits?", options: ["Valve tube", "Solid-state diode", "Rheostat", "Autotransformer"], correct: 1, explanation: "Solid-state silicon diodes are used in modern equipment to ensure electrons flow in only one direction (DC)." },
    { id: 10, q: "The 'Air Gap Technique' works similarly to a grid by:", options: ["Absorbing scatter", "Allowing scatter to miss the image receptor", "Increasing scatter production", "Filtering the beam"], correct: 1, explanation: "A large OID (Air Gap) allows scattered photons to diverge away from the image receptor, improving contrast." },
    { id: 11, q: "High-frequency generators produce a voltage ripple of approximately:", options: ["100%", "14%", "4%", "<1%"], correct: 3, explanation: "High-frequency generators are the most efficient, producing a near-constant potential with less than 1% ripple." },
    { id: 12, q: "The standard anode rotation speed for a diagnostic tube is:", options: ["10,000 rpm", "3,000 - 3,600 rpm", "500 rpm", "1,000 rpm"], correct: 1, explanation: "Standard tubes rotate at 3,000-3,600 rpm. High-capacity tubes rotate at ~10,000 rpm." },
    { id: 13, q: "Bremsstrahlung radiation is produced when:", options: ["An inner shell electron is ejected", "An electron slows down near the nucleus", "A neutron is absorbed", "An electron hits another electron"], correct: 1, explanation: "Bremsstrahlung ('Braking radiation') occurs when a projectile electron is slowed down by the nuclear force field of the target atom." },
    { id: 14, q: "Characteristic radiation from a Tungsten target has an effective energy of approx:", options: ["69 keV", "100 keV", "20 keV", "40 keV"], correct: 0, explanation: "The binding energy difference between the K and L shells in Tungsten produces a characteristic photon of roughly 69 keV." },
    { id: 15, q: "Which transformer law states that voltage is directly proportional to the number of turns?", options: ["Ohm's Law", "Transformer Law", "Inverse Square Law", "Reciprocity Law"], correct: 1, explanation: "Vs/Vp = Ns/Np. Voltage is directly proportional to the turns ratio." },
    { id: 16, q: "Thermionic emission occurs at the:", options: ["Anode target", "Filament of the cathode", "Focusing cup", "Output phosphor"], correct: 1, explanation: "Heating the filament causes electrons to boil off, a process called thermionic emission." },
    { id: 17, q: "The unit of electric potential is:", options: ["Ampere", "Volt", "Ohm", "Watt"], correct: 1, explanation: "Volt is the unit of electric potential or electromotive force." },
    { id: 18, q: "To double the radiographic density using kVp, one needs to increase kVp by:", options: ["15%", "50%", "100%", "30%"], correct: 0, explanation: "The 15% Rule states that increasing kVp by 15% has the same effect on density as doubling the mAs." },
    { id: 19, q: "A 'Spinning Top Test' on a single-phase half-wave rectified unit showing 6 dots implies an exposure time of:", options: ["0.1 sec (at 60Hz)", "0.05 sec", "0.2 sec", "1.0 sec"], correct: 0, explanation: "Half-wave rectification produces 60 pulses/sec (at 60Hz). 0.1 sec x 60 = 6 dots." },
    { id: 20, q: "The input phosphor of an Image Intensifier is usually made of:", options: ["Zinc Cadmium Sulfide", "Cesium Iodide", "Calcium Tungstate", "Gadolinium"], correct: 1, explanation: "Cesium Iodide (CsI) is used for its high absorption efficiency and needle-like structure to minimize light spread." },

    // --- POSITIONING & ANATOMY ---
    { id: 21, q: "The 'Waters View' (Parietoacanthial) is primarily used to demonstrate:", options: ["Frontal Sinuses", "Maxillary Sinuses", "Sphenoid Sinuses", "Ethmoid Sinuses"], correct: 1, explanation: "This projection places the petrous ridges below the maxillary sinuses, allowing for a clear view of fluid levels." },
    { id: 22, q: "Which view best demonstrates the Scaphoid bone without foreshortening?", options: ["PA Wrist", "Lateral Wrist", "PA Ulnar Deviation", "PA Radial Deviation"], correct: 2, explanation: "Ulnar deviation extends the scaphoid, preventing it from overlapping on itself." },
    { id: 23, q: "The 'Towne View' (AP Axial) requires a caudal tube angle of:", options: ["15 degrees", "30 degrees", "45 degrees", "10 degrees"], correct: 1, explanation: "A 30-degree caudal angle is standard to project the dorsum sellae within the foramen magnum." },
    { id: 24, q: "The 'Swimmer’s View' is used to visualize the:", options: ["C1-C2 joint", "C7-T1 junction", "Lumbar spine", "Thoracic spine"], correct: 1, explanation: "It is a lateral projection used when the shoulders obscure the C7-T1 area." },
    { id: 25, q: "For a lateral projection of the knee, the knee should be flexed:", options: ["90 degrees", "45 degrees", "20-30 degrees", "0 degrees"], correct: 2, explanation: "20-30 degrees flexion relaxes the muscles and prevents the patella from being drawn into the intercondylar groove." },
    { id: 26, q: "The 'Y-View' of the shoulder is useful for detecting:", options: ["Fracture of Clavicle", "Dislocation", "Rotator cuff tear", "AC joint separation"], correct: 1, explanation: "The Scapular Y view shows the relationship of the humeral head to the glenoid, helping identify anterior/posterior dislocation." },
    { id: 27, q: "Which projection best demonstrates the Intercondylar Fossa?", options: ["AP Knee", "Lateral Knee", "Tunnel View (Camp Coventry/Holmblad)", "Merchant View"], correct: 2, explanation: "Tunnel views are specifically designed to open up the intercondylar fossa." },
    { id: 28, q: "The 'Stenvers View' visualizes the:", options: ["Optic Foramen", "Petrous Temporal Bone", "Mandible", "Zygoma"], correct: 1, explanation: "It is an oblique view used to see the petrous ridge, bony labyrinth, and internal acoustic meatus." },
    { id: 29, q: "The anatomical landmark for the T7 vertebra is the:", options: ["Sternal Angle", "Inferior Angle of Scapula", "Xiphoid Process", "Jugular Notch"], correct: 1, explanation: "The inferior angle of the scapula lies at the level of T7." },
    { id: 30, q: "A 'Colles Fracture' is a fracture of the:", options: ["Distal Radius", "Distal Ulna", "Proximal Humerus", "Scaphoid"], correct: 0, explanation: "Colles fracture is a fracture of the distal radius with dorsal displacement." },
    { id: 31, q: "The 'Frog-Leg' lateral position is used for the:", options: ["Knee", "Hip", "Ankle", "Shoulder"], correct: 1, explanation: "It is a modified lateral to visualize the femoral neck and head." },
    { id: 32, q: "Which view demonstrates the Greater Tuberosity of the humerus in profile?", options: ["AP External Rotation", "AP Internal Rotation", "Transthoracic Lateral", "Axial View"], correct: 0, explanation: "External rotation places the greater tuberosity laterally in profile." },
    { id: 33, q: "The 'Lordotic View' of the chest is used to visualize:", options: ["Lung bases", "Heart size", "Lung apices", "Rib fractures"], correct: 2, explanation: "It projects the clavicles above the apices, allowing a clear view of apical pathology (e.g., TB)." },
    { id: 34, q: "For a PA Chest X-ray, the recommended SID is:", options: ["100 cm", "180 cm (72 inches)", "90 cm", "120 cm"], correct: 1, explanation: "72 inches minimizes magnification of the heart." },
    { id: 35, q: "The 'Gaynor-Hart' method demonstrates the:", options: ["Carpal Tunnel", "Tarsal Sinus", "Glenoid Fossa", "Sella Turcica"], correct: 0, explanation: "It is a tangential inferosuperior projection to visualize the carpal canal." },
    { id: 36, q: "The 'Scottie Dog' sign is seen in which view of the spine?", options: ["AP Lumbar", "Lateral Lumbar", "Oblique Lumbar", "AP Sacrum"], correct: 2, explanation: "The oblique lumbar view visualizes the pars interarticularis, which appears as the neck of the dog." },
    { id: 37, q: "In the Scottie Dog, the 'Eye' represents the:", options: ["Pedicle", "Transverse Process", "Superior Articular Process", "Pars Interarticularis"], correct: 0, explanation: "Pedicle = Eye, Transverse Process = Nose, Pars = Neck, Superior Articular Process = Ear, Inferior Articular Process = Front Leg." },
    { id: 38, q: "The 'Judet View' is used for:", options: ["Acetabulum", "Ilio-sacral joint", "Pubic Symphysis", "Femoral Neck"], correct: 0, explanation: "Judet views (internal and external obliques) are used to assess acetabular fractures." },
    { id: 39, q: "Which bone contains the 'Sella Turcica'?", options: ["Frontal", "Ethmoid", "Sphenoid", "Temporal"], correct: 2, explanation: "The Sella Turcica (Turkish Saddle) houses the pituitary gland and is part of the Sphenoid bone." },
    { id: 40, q: "The 'Mortise View' is specific to the:", options: ["Wrist", "Elbow", "Ankle", "Hip"], correct: 2, explanation: "It is a 15-20 degree internal oblique view of the ankle to eliminate overlap of the tibia and fibula." },

    // --- CT & MRI ---
    { id: 41, q: "The Hounsfield Unit (HU) for water is:", options: ["-1000", "0", "+1000", "+100"], correct: 1, explanation: "The CT scale is calibrated such that Water = 0 HU and Air = -1000 HU." },
    { id: 42, q: "In CT, 'Pitch' is defined as:", options: ["Table movement per rotation / Beam width", "Beam width / Table movement", "Slice thickness / Time", "mA / kVp"], correct: 0, explanation: "Pitch > 1 means the table moves faster than the beam width (gaps/lower dose); Pitch < 1 means overlap (higher dose)." },
    { id: 43, q: "Which generation of CT scanners introduced the 'Rotate-Rotate' geometry?", options: ["First", "Second", "Third", "Fourth"], correct: 2, explanation: "3rd Generation scanners use a rotating X-ray tube and a rotating detector array." },
    { id: 44, q: "A 'Window Width' of 2000 in CT results in:", options: ["High contrast image", "Low contrast (Long gray scale) image", "Brighter image", "Darker image"], correct: 1, explanation: "A wide window displays a wide range of tissue densities as shades of gray, resulting in low contrast (used for bone/lung)." },
    { id: 45, q: "Beam hardening artifacts in CT appear as:", options: ["Rings", "Dark bands or streaks", "Blurring", "Noise"], correct: 1, explanation: "As the beam passes through dense objects, lower energy photons are absorbed, leaving a 'harder' beam, causing dark streaks." },
    { id: 46, q: "In MRI, T1 relaxation time is also known as:", options: ["Spin-Lattice relaxation", "Spin-Spin relaxation", "Transverse relaxation", "Free induction decay"], correct: 0, explanation: "T1 is Spin-Lattice (longitudinal recovery); T2 is Spin-Spin (transverse decay)." },
    { id: 47, q: "On a T2-weighted MRI image, water/fluid appears:", options: ["Dark (Hypointense)", "Bright (Hyperintense)", "Grey", "Invisible"], correct: 1, explanation: "Fluid has a long T2 time, so it appears bright on T2-weighted images (remember: H2O is bright on T2)." },
    { id: 48, q: "The unit of magnetic field strength is:", options: ["Tesla", "Watt", "Volt", "Hertz"], correct: 0, explanation: "1 Tesla = 10,000 Gauss. Most clinical scanners are 1.5T or 3T." },
    { id: 49, q: "Which of the following is an absolute contraindication for MRI?", options: ["Hip replacement (Titanium)", "Cardiac Pacemaker (non-MRI conditional)", "Dental fillings", "Intrauterine device (Copper)"], correct: 1, explanation: "Conventional pacemakers can malfunction or overheat in the magnetic field." },
    { id: 50, q: "Gadolinium contrast agents are primarily:", options: ["Paramagnetic", "Diamagnetic", "Ferromagnetic", "Radioactive"], correct: 0, explanation: "Gadolinium is paramagnetic; it shortens the T1 relaxation time of nearby protons, making them appear brighter on T1 images." },
    { id: 51, q: "The term 'Quench' in MRI refers to:", options: ["Rapid loss of liquid helium", "Patient panic attack", "RF coil failure", "Computer crash"], correct: 0, explanation: "Quenching is the sudden loss of superconductivity, causing the liquid helium to boil off rapidly as gas." },
    { id: 52, q: "Diffusion Weighted Imaging (DWI) is the gold standard for detecting:", options: ["Acute Ischemic Stroke", "Bone fractures", "Liver cysts", "Multiple Sclerosis"], correct: 0, explanation: "DWI can detect restricted diffusion in ischemic stroke within minutes of onset." },
    { id: 53, q: "In CT, the 'Voxel' represents:", options: ["2D area", "3D volume element", "Matrix size", "Field of view"], correct: 1, explanation: "Pixel is 2D; Voxel (Volume Element) is 3D, including the slice thickness." },
    { id: 54, q: "Which artifact appears as concentric rings in a CT image?", options: ["Motion artifact", "Ring artifact", "Beam hardening", "Partial volume"], correct: 1, explanation: "Ring artifacts are caused by a miscalibrated or defective detector element in 3rd gen scanners." },
    { id: 55, q: "The standard window settings for a CT Brain (Soft Tissue) are approx:", options: ["W:80 L:40", "W:1500 L:-600", "W:2500 L:500", "W:300 L:50"], correct: 0, explanation: "Brain tissue has very low contrast, so a narrow window (W:80) is used to differentiate grey/white matter." },

    // --- RADIATION SAFETY & BIOLOGY ---
    { id: 56, q: "The annual whole-body effective dose limit for radiation workers (AERB) is:", options: ["5 mSv", "20 mSv", "50 mSv", "100 mSv"], correct: 1, explanation: "20 mSv per year averaged over 5 consecutive years, with no single year exceeding 50 mSv." },
    { id: 57, q: "The dose limit for the general public is:", options: ["1 mSv/year", "5 mSv/year", "20 mSv/year", "0.5 mSv/year"], correct: 0, explanation: "The limit is 1 mSv per year for non-radiation workers/public." },
    { id: 58, q: "ALARA stands for:", options: ["As Low As Reasonably Achievable", "Always Limit Annual Radiation Areas", "As Long As Radiation Allows", "Allow Low Area Radiation Absorption"], correct: 0, explanation: "ALARA is the fundamental principle of radiation protection." },
    { id: 59, q: "Which of the following is a Deterministic (Non-Stochastic) effect?", options: ["Leukemia", "Genetic mutations", "Cataract", "Breast Cancer"], correct: 2, explanation: "Deterministic effects (like cataracts, erythema) have a threshold dose below which they do not occur. Cancer is Stochastic (no threshold)." },
    { id: 60, q: "The Law of Bergonie and Tribondeau states that cells are most radiosensitive if they are:", options: ["Mature and specialized", "Rapidly dividing and undifferentiated", "Non-dividing", "Differentiated"], correct: 1, explanation: "Stem cells and rapidly dividing cells (like bone marrow, GI lining) are most sensitive." },
    { id: 61, q: "The active component in a TLD (Thermoluminescent Dosimeter) badge is:", options: ["Lithium Fluoride (LiF)", "Silver Halide", "Aluminum Oxide", "Sodium Iodide"], correct: 0, explanation: "LiF is used because its effective atomic number is similar to tissue." },
    { id: 62, q: "Which monitoring device provides an immediate reading?", options: ["Film Badge", "TLD", "Pocket Dosimeter", "OSL"], correct: 2, explanation: "Pocket ionization chambers provide immediate readout but no permanent record." },
    { id: 63, q: "The lead equivalent thickness for a protective apron in fluoroscopy (up to 100 kVp) should be at least:", options: ["0.25 mm Pb", "0.5 mm Pb", "1.0 mm Pb", "0.1 mm Pb"], correct: 0, explanation: "0.25 mm is the minimum, though 0.5 mm is standard for better protection." },
    { id: 64, q: "Radiation protection of the patient is primarily governed by:", options: ["Distance", "Time", "Shielding", "Justification and Optimization"], correct: 3, explanation: "While Time/Distance/Shielding are for staff, Patient protection relies on Justification (is it necessary?) and Optimization (ALARA)." },
    { id: 65, q: "The Inverse Square Law states that if you double the distance from the source, the intensity becomes:", options: ["Half", "Double", "One-fourth", "Four times"], correct: 2, explanation: "Intensity is inversely proportional to the square of the distance (1/2² = 1/4)." },
    { id: 66, q: "The 'LD 50/60' for humans is approximately:", options: ["0.5 Gy", "3-4 Gy", "10 Gy", "20 Gy"], correct: 1, explanation: "The Lethal Dose to kill 50% of the population in 60 days is about 3-4 Gray without medical intervention." },
    { id: 67, q: "Which stage of the cell cycle is most radiosensitive?", options: ["S Phase", "M (Mitosis) Phase", "G1 Phase", "G2 Phase"], correct: 1, explanation: "Cells are most vulnerable during Mitosis." },
    { id: 68, q: "1 Gray (Gy) is equivalent to:", options: ["100 Rads", "10 Rads", "1000 Rads", "1 Rad"], correct: 0, explanation: "1 Gy = 100 Rads (Radiation Absorbed Dose)." },
    { id: 69, q: "The Radiation Weighting Factor (Wr) for Alpha particles is:", options: ["1", "5", "10", "20"], correct: 3, explanation: "Alpha particles are very damaging (high LET), so they have a weighting factor of 20. X-rays have a factor of 1." },
    { id: 70, q: "Fetal dose limit for a pregnant radiographer for the entire gestation is:", options: ["5 mSv", "1 mSv", "20 mSv", "50 mSv"], correct: 1, explanation: "The limit is 1 mSv to the fetus for the duration of the pregnancy." },

    // --- DIGITAL & DARKROOM ---
    { id: 71, q: "The latent image in Computed Radiography (CR) is stored in the:", options: ["Amorphous Selenium", "Photostimulable Phosphor (PSP) Plate", "CCD", "Film Emulsion"], correct: 1, explanation: "The PSP plate (usually Barium Fluorohalide) traps electrons to store the image." },
    { id: 72, q: "DICOM stands for:", options: ["Digital Image Communication in Medicine", "Direct Imaging Computer Output Method", "Digital Instrument Control and Management", "Dual Imaging Computer Mode"], correct: 0, explanation: "DICOM is the universal standard for transmitting medical images." },
    { id: 73, q: "PACS stands for:", options: ["Patient Access and Control System", "Picture Archiving and Communication System", "Primary Area Control Section", "Physician Access Computer Station"], correct: 1, explanation: "PACS is used for storage, retrieval, and distribution of images." },
    { id: 74, q: "Quantum Mottle (grainy image) is caused by:", options: ["High mAs", "Insufficient signal (Low mAs)", "High kVp", "Grid artifacts"], correct: 1, explanation: "It is photon starvation; not enough X-ray photons reached the detector." },
    { id: 75, q: "The developer solution in manual processing is:", options: ["Acidic", "Alkaline", "Neutral", "Water"], correct: 1, explanation: "Developer is Alkaline (pH ~10); Fixer is Acidic." },
    { id: 76, q: "The 'Rotten Egg' smell in a darkroom is caused by:", options: ["Old Developer", "Contaminated Fixer (Sulfur)", "Acetic Acid", "Silver"], correct: 1, explanation: "It usually indicates the breakdown of sulfur in the fixer or old chemicals." },
    { id: 77, q: "Which chemical acts as the 'Clearing Agent' in the fixer?", options: ["Hydroquinone", "Ammonium Thiosulfate", "Potassium Bromide", "Phenidone"], correct: 1, explanation: "Ammonium (or Sodium) Thiosulfate removes the unexposed silver halide crystals." },
    { id: 78, q: "High Detective Quantum Efficiency (DQE) means the detector is:", options: ["Less efficient", "Highly efficient at converting X-rays to image", "Producing more noise", "Requiring more dose"], correct: 1, explanation: "High DQE means the system is very efficient, potentially allowing for lower patient dose." },
    { id: 79, q: "Pixel Pitch refers to the:", options: ["Number of pixels", "Distance from the center of one pixel to the center of the next", "Size of the monitor", "Bit depth"], correct: 1, explanation: "Smaller pixel pitch results in higher spatial resolution." },
    { id: 80, q: "A 'Bit Depth' of 8 allows for how many shades of gray?", options: ["256", "8", "64", "1024"], correct: 0, explanation: "2 to the power of 8 (2^8) = 256 shades." },

    // --- SPECIAL PROCEDURES & CONTRAST ---
    { id: 81, q: "Positive contrast media (like Barium/Iodine) appear:", options: ["Radiolucent (Dark)", "Radiopaque (Bright)", "Grey", "Invisible"], correct: 1, explanation: "High atomic number absorbs X-rays, appearing white." },
    { id: 82, q: "HSG (Hysterosalpingography) is used to evaluate:", options: ["Uterine pathology & Fallopian tube patency", "Bladder stones", "Renal arteries", "Gallbladder"], correct: 0, explanation: "It is the gold standard for tubal patency in infertility cases." },
    { id: 83, q: "Intravenous Urography (IVU) compression is contraindicated in:", options: ["Hypertension", "Recent abdominal surgery / Aortic Aneurysm", "Diabetes", "Asthma"], correct: 1, explanation: "Compression could harm a recent surgical site or rupture an aneurysm." },
    { id: 84, q: "ERCP is a procedure to visualize the:", options: ["Renal Pelvis", "Biliary and Pancreatic Ducts", "Colon", "Bronchi"], correct: 1, explanation: "Endoscopic Retrograde Cholangiopancreatography." },
    { id: 85, q: "Which drug is the first-line treatment for anaphylactic shock?", options: ["Adrenaline (Epinephrine)", "Atropine", "Digoxin", "Furosemide"], correct: 0, explanation: "Adrenaline reverses the effects of anaphylaxis (vasodilation, bronchoconstriction)." },
    { id: 86, q: "Barium Sulfate is:", options: ["Water soluble", "Insoluble suspension", "A gas", "Used IV"], correct: 1, explanation: "It is an insoluble suspension, which is why it cannot be used if perforation is suspected." },
    { id: 87, q: "If a bowel perforation is suspected, the contrast of choice is:", options: ["Barium Sulfate", "Water-soluble iodinated contrast (Gastrografin)", "Air", "Gadolinium"], correct: 1, explanation: "Water-soluble contrast can be absorbed by the body if it leaks; Barium causes peritonitis." },
    { id: 88, q: "Sialography is the study of:", options: ["Sinuses", "Salivary Glands", "Spinal Cord", "Joints"], correct: 1, explanation: "It involves injecting contrast into the salivary ducts." },
    { id: 89, q: "Which catheter shape is commonly used for coronary angiography?", options: ["Pigtail", "Judkins", "Foley", "Swan-Ganz"], correct: 1, explanation: "Judkins catheters are pre-shaped for coronary arteries." },
    { id: 90, q: "The Seldinger technique is used for:", options: ["Developing film", "Vascular access (Arterial puncture)", "CT reconstruction", "MRI tuning"], correct: 1, explanation: "It is the standard method for gaining access to blood vessels using a needle, guidewire, and catheter." },

    // --- MISCELLANEOUS / ULTRASOUND ---
    { id: 91, q: "Ultrasound uses the ______ effect to generate sound waves.", options: ["Photoelectric", "Piezoelectric", "Compton", "Doppler"], correct: 1, explanation: "Crystals vibrate when electricity is applied (Piezoelectric effect) to create sound." },
    { id: 92, q: "The typical frequency range for diagnostic ultrasound is:", options: ["20-20,000 Hz", "2-15 MHz", "500 kHz", "1 GHz"], correct: 1, explanation: "Diagnostic USG uses MegaHertz (MHz) frequencies." },
    { id: 93, q: "In USG, high frequency probes provide:", options: ["Better penetration, lower resolution", "Better resolution, less penetration", "High speed", "Wider field of view"], correct: 1, explanation: "High frequency = Short wavelength = High detail but poor depth." },
    { id: 94, q: "DEXA is the gold standard for measuring:", options: ["Bone Metastases", "Bone Mineral Density (Osteoporosis)", "Bone fractures", "Bone infection"], correct: 1, explanation: "Dual-Energy X-ray Absorptiometry." },
    { id: 95, q: "T-Score in DEXA refers to comparison with:", options: ["Age-matched peers", "Young healthy adult", "Pre-pubertal child", "Previous scan"], correct: 1, explanation: "T-Score compares BMD to a peak bone mass (young healthy adult)." },
    { id: 96, q: "The safelight filter for green-sensitive film is:", options: ["Amber", "Red (GBX-2)", "Blue", "Clear"], correct: 1, explanation: "Green-sensitive (Ortho) film requires a specific Red filter (GBX-2)." },
    { id: 97, q: "Replenishment in automatic processors maintains the:", options: ["Temperature", "Transport speed", "Chemical strength and level", "Drying time"], correct: 2, explanation: "It adds fresh chemical to replace what is used up." },
    { id: 98, q: "Hypovolemic shock is caused by:", options: ["Allergic reaction", "Loss of blood/fluid", "Heart failure", "Sepsis"], correct: 1, explanation: "Hypo (low) Vol (volume) = low blood volume." },
    { id: 99, q: "Nosocomial infections are:", options: ["Community acquired", "Hospital acquired", "Genetic", "Viral only"], correct: 1, explanation: "Infections acquired 48 hours after admission to a healthcare facility." },
    { id: 100, q: "Normal adult pulse rate is:", options: ["60-100 bpm", "40-60 bpm", "100-120 bpm", "20-40 bpm"], correct: 0, explanation: "Standard resting heart rate range." }
];

    // To make this fully functional, I will programmatically generate the rest to reach 100 for the demo.
    // NOTE: You should replace the array below with the full 100 items from the previous response if you want specific questions.
    
    // Let's add the remaining questions from previous prompts into the main array for a complete experience.
    const extraQuestions = [
         { id: 26, q: "The 'Y-view' of the shoulder demonstrates:", options: ["Clavicle fracture", "Shoulder Dislocation", "AC joint", "Bicipital groove"], correct: 1, explanation: "The Scapular Y view puts the scapula in profile and is excellent for checking anterior/posterior dislocation." },
         { id: 27, q: "Judet view evaluates:", options: ["Acetabulum", "Scapula", "Calcaneus", "Mandible"], correct: 0, explanation: "Judet views (Internal/External oblique) visualize the columns of the acetabulum." },
         { id: 28, q: "Skyline view (Merchant) is for:", options: ["Calcaneus", "Patellofemoral joint", "AC joint", "Zygoma"], correct: 1, explanation: "Skyline/Sunrise/Merchant views visualize the patella and the patellofemoral joint space." },
         { id: 29, q: "Which landmark corresponds to L4-L5?", options: ["Xiphoid", "Costal Margin", "Iliac Crest", "Symphysis Pubis"], correct: 2, explanation: "The highest point of the iliac crest is at the level of the L4-L5 interspace." },
         { id: 30, q: "Colles fracture involves:", options: ["Distal Radius", "Distal Humerus", "Proximal Tibia", "Scaphoid"], correct: 0, explanation: "Colles fracture is a fracture of the distal radius with dorsal displacement." },
         { id: 90, q: "PACS stands for:", options: ["Patient Access System", "Picture Archiving and Communication System", "Primary Area Control", "Physician Access"], correct: 1, explanation: "PACS is the standard for storing, retrieving, and distributing medical images." }
         // Add as many as needed...
    ];
    
    // Merging for the demo to ensure at least ~30 questions are playable. 
    // In your final file, ensure IDs 1-100 are present.
    extraQuestions.forEach(q => {
        if(!questionsDB.find(x => x.id === q.id)) questionsDB.push(q);
    });
    
    // Sort by ID
    questionsDB.sort((a,b) => a.id - b.id);

    // --- APP LOGIC ---
    let answers = JSON.parse(localStorage.getItem('aiims_review_answers')) || {};
    let isReviewMode = false;
    
    function renderQuiz() {
        const list = document.getElementById('quiz-list');
        list.innerHTML = '';

        questionsDB.forEach((q, idx) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            
            // Build Question Header
            const header = document.createElement('div');
            header.className = 'q-header';
            header.innerHTML = `<div class="q-num">Q${q.id}</div><div class="q-text">${q.q}</div>`;
            card.appendChild(header);

            // Options Container
            const optList = document.createElement('div');
            optList.className = 'options-list';
            
            const userSelected = answers[q.id];

            q.options.forEach((txt, optIdx) => {
                const item = document.createElement('div'); // Changed to div for review control
                item.className = 'option-item';
                
                // --- REVIEW MODE LOGIC ---
                if(isReviewMode) {
                    item.style.cursor = 'default'; // Disable clicking
                    
                    // Mark Correct Answer Green
                    if(optIdx === q.correct) {
                        item.classList.add('review-correct');
                        item.innerHTML = `<strong>✓</strong> <span class="opt-text">${txt}</span>`;
                    }
                    // Mark Wrong User Selection Red
                    else if(userSelected === optIdx && userSelected !== q.correct) {
                        item.classList.add('review-wrong');
                        item.innerHTML = `<strong>✗</strong> <span class="opt-text">${txt}</span>`;
                    } 
                    // Normal option
                    else {
                        item.innerHTML = `<span style="width:15px"></span><span class="opt-text">${txt}</span>`;
                    }
                } 
                // --- QUIZ MODE LOGIC ---
                else {
                    // Selection State
                    if(userSelected === optIdx) item.classList.add('selected');
                    
                    // Click Event
                    item.onclick = () => {
                        answers[q.id] = optIdx;
                        localStorage.setItem('aiims_review_answers', JSON.stringify(answers));
                        renderQuiz(); // Re-render to update UI
                        updateCounter();
                    };

                    item.innerHTML = `
                        <input type="radio" name="q${q.id}" ${userSelected === optIdx ? 'checked' : ''}>
                        <span class="opt-text">${txt}</span>
                    `;
                }
                optList.appendChild(item);
            });
            card.appendChild(optList);

            // --- EXPLANATION BOX (Only in Review Mode) ---
            if(isReviewMode) {
                const expBox = document.createElement('div');
                expBox.className = 'explanation-box';
                expBox.style.display = 'block';
                // Default explanation if missing
                const expText = q.explanation || "The correct answer is highlighted based on standard radiographic principles.";
                expBox.innerHTML = `<strong>Explanation:</strong> ${expText}`;
                card.appendChild(expBox);
            }

            list.appendChild(card);
        });
        updateCounter();
    }

    function updateCounter() {
        document.getElementById('attempted-count').innerText = Object.keys(answers).length;
    }

    function submitExam() {
        if(!confirm("Are you sure you want to finish the exam?")) return;

        let correct = 0, incorrect = 0, skipped = 0;
        
        questionsDB.forEach(q => {
            const userAns = answers[q.id];
            if(userAns === undefined) skipped++;
            else if(userAns === q.correct) correct++;
            else incorrect++;
        });

        const score = (correct * 4) - (incorrect * 1);
        const attempted = correct + incorrect;
        const accuracy = attempted === 0 ? 0 : Math.round((correct/attempted)*100);

        // Fill Modal
        document.getElementById('final-score').innerText = score;
        document.getElementById('res-correct').innerText = correct;
        document.getElementById('res-incorrect').innerText = incorrect;
        document.getElementById('res-skipped').innerText = skipped;
        document.getElementById('res-accuracy').innerText = accuracy + '%';

        document.getElementById('result-modal').style.display = 'flex';
    }

    function startReviewMode() {
        isReviewMode = true;
        document.getElementById('result-modal').style.display = 'none';
        document.getElementById('main-action-btn').style.display = 'none'; // Hide submit button
        document.getElementById('status-badge').innerHTML = "REVIEW MODE";
        document.getElementById('status-badge').style.background = "#10b981"; // Green badge
        window.scrollTo(0,0);
        renderQuiz(); // Re-render with review styles
    }

    function resetExam() {
        if(confirm("This will delete all progress and restart. Continue?")) {
            localStorage.removeItem('aiims_review_answers');
            location.reload();
        }
    }

    // Initialize
    renderQuiz();

</script>

</body>
</html>
