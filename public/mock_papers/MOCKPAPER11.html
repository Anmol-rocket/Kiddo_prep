<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AIIMS CRE Radiographer - Paper 4</title>

<style>
:root{
  --primary:#e11d48;
  --secondary:#9f1239;
  --bg:#fff1f2;
  --text:#1f2937;
  --correct:#10b981;
  --wrong:#ef4444;
}

*{box-sizing:border-box}
body{
  font-family:system-ui,-apple-system;
  background:var(--bg);
  margin:0;
  padding-bottom:80px;
}

.container{max-width:900px;margin:auto;padding:15px}

header{
  background:#fff;
  position:sticky;top:0;z-index:10;
  padding:12px 15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-top:4px solid var(--secondary);
  border-radius:0 0 12px 12px;
}

h1{margin:0;font-size:1.1rem;color:var(--secondary)}
.exam-info{font-size:.75rem;color:#666}

#progress-indicator{
  background:#fff;
  padding:5px 12px;
  border-radius:20px;
  font-weight:600;
}

.question-card{
  background:#fff;
  margin-top:15px;
  padding:20px;
  border-radius:12px;
}

.question-text{
  font-weight:600;
  margin-bottom:15px;
}

.options-grid{
  display:flex;
  flex-direction:column;
  gap:8px;
}

.option-label{
  display:flex;
  gap:10px;
  padding:12px;
  border:1px solid #e5e7eb;
  border-radius:8px;
  cursor:pointer;
}

.option-label.selected{
  border-color:var(--primary);
  background:#fff1f2;
  font-weight:500;
}

.option-label.correct{
  border-color:var(--correct);
  background:#dcfce7;
  font-weight:600;
}

.option-label.wrong{
  border-color:var(--wrong);
  background:#fee2e2;
  font-weight:600;
}

input[type=radio]{
  accent-color:var(--primary);
  margin-top:3px;
}

.explanation{
  margin-top:10px;
  font-size:.9rem;
  color:#374151;
}

.submit-btn{
  width:100%;
  margin-top:25px;
  padding:16px;
  background:var(--secondary);
  color:#fff;
  border:none;
  border-radius:10px;
  font-size:1.05rem;
  font-weight:700;
}

/* RESULT MODAL */
#result-modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  z-index:100;
  align-items:center;
  justify-content:center;
  padding:20px;
}

.result-box{
  background:#fff;
  width:100%;
  max-width:420px;
  padding:25px;
  border-radius:16px;
  text-align:center;
}

.score{
  font-size:2.4rem;
  font-weight:800;
  color:var(--primary);
}

.result-btn{
  width:100%;
  margin-top:10px;
  padding:14px;
  border:none;
  border-radius:8px;
  font-weight:600;
}

.review-btn{background:var(--primary);color:#fff}
.reset-btn{background:#374151;color:#fff}
</style>
</head>

<body>
<div class="container">
<header>
  <div>
    <h1>AIIMS CRE Paper 4</h1>
    <div class="exam-info">400 Marks | +4 / -1</div>
  </div>
  <div id="progress-indicator">
    <span id="attempt-count">0</span> / 100
  </div>
</header>

<div id="quiz-container"></div>

<button class="submit-btn" onclick="submitExam()">SUBMIT PAPER 4</button>
</div>

<!-- RESULT -->
<div id="result-modal">
<div class="result-box">
  <h2>Result</h2>
  <div class="score"><span id="final-score">0</span>/400</div>
  <p>
    Correct: <b id="count-correct"></b> |
    Wrong: <b id="count-wrong"></b> |
    Skipped: <b id="count-skipped"></b><br>
    Accuracy: <b id="accuracy"></b>%
  </p>
  <button class="result-btn review-btn" onclick="startReview()">REVIEW PAPER</button>
  <button class="result-btn reset-btn" onclick="resetExam()">RESET</button>
</div>
</div>

<script>
const questionsDB = [
    // --- ADVANCED PHYSICS & EQUIPMENT ---
    { id: 1, q: "The binding energy of the K-shell electron in a Tungsten atom is approximately:", options: ["69.5 keV", "12 keV", "33 keV", "88 keV"], correct: 0, explanation: "The K-shell binding energy of Tungsten is approx 69.5 keV. Incident electrons must have energy higher than this to produce characteristic K-radiation." },
    { id: 2, q: "Which voltage ripple percentage corresponds to a Three-Phase, 12-Pulse generator?", options: ["13-14%", "3-4%", "100%", "<1%"], correct: 1, explanation: "Single phase = 100%; 3-phase 6-pulse = 13-14%; 3-phase 12-pulse = 3.5-4%; High Frequency = <1%." },
    { id: 3, q: "The 'Grid Conversion Factor' (Bucky Factor) for a 16:1 grid is approximately:", options: ["2", "4", "6", "8"], correct: 2, explanation: "As grid ratio increases, the Bucky factor increases. 5:1 is ~2, 8:1 is ~4, 12:1 is ~5, and 16:1 is ~6." },
    { id: 4, q: "In the context of X-ray interactions, 'Pair Production' only occurs at energies greater than:", options: ["1.02 MeV", "10 MeV", "140 keV", "511 keV"], correct: 0, explanation: "The incident photon must possess at least 1.02 MeV of energy to create a positron-electron pair." },
    { id: 5, q: "Which component of the Image Intensifier contributes most to the 'Flux Gain'?", options: ["Input Phosphor size", "Accelerating Anode voltage", "Output Phosphor efficiency", "Focusing lenses"], correct: 1, explanation: "Flux gain is primarily achieved by the acceleration of electrons across the tube by a high potential difference (25kV)." },
    { id: 6, q: "The 'Modulation Transfer Function' (MTF) of an ideal imaging system is:", options: ["0", "0.5", "1", "10"], correct: 2, explanation: "MTF represents the system's ability to transfer contrast. An ideal system preserves 100% signal, so MTF = 1." },
    { id: 7, q: "Due to the Anode Heel Effect, the radiation intensity on the cathode side can be higher than the anode side by up to:", options: ["5-10%", "20-25%", "45%", "100%"], correct: 2, explanation: "Depending on the anode angle and film size, the intensity variation can be as high as 45%." },
    { id: 8, q: "What is the specific heat capacity of the Tungsten anode?", options: ["High", "Low", "Infinite", "Variable"], correct: 1, explanation: "Tungsten actually has a relatively LOW specific heat capacity, which is why it heats up quickly. However, it has a high melting point and thermal conductivity." },
    { id: 9, q: "The tolerance limit for 'Collimator vs Light Beam Alignment' according to QA standards is:", options: ["± 1% of SID", "± 2% of SID", "± 5% of SID", "± 10% of SID"], correct: 1, explanation: "Standard regulatory limit (AERB/FDA) is ± 2% of the Source-to-Image Distance (SID)." },
    { id: 10, q: "A 'Wedge Filter' is primarily used for radiography of the:", options: ["Chest", "Foot (AP)", "Skull", "Abdomen"], correct: 1, explanation: "It compensates for the difference in thickness between the toes and the tarsus in a foot X-ray." },
    { id: 11, q: "The 'K-edge' absorption peak of Iodine (contrast medium) is at:", options: ["33 keV", "69 keV", "50 keV", "20 keV"], correct: 0, explanation: "Iodine's K-edge is ~33 keV. X-ray beam energy should be slightly above this for maximum contrast." },
    { id: 12, q: "Which test tool is used to measure the 'Resolution' (Line pairs/mm) of an X-ray system?", options: ["Spinning Top", "Star Pattern / Resolution Bar", "Step Wedge", "Densitometer"], correct: 1, explanation: "A Star Pattern or Resolution Bar test object is used to determine spatial resolution." },
    { id: 13, q: "If the FOV is 300mm and the Matrix size is 1024x1024, the Pixel Size is approx:", options: ["0.3 mm", "3.0 mm", "0.1 mm", "1.0 mm"], correct: 0, explanation: "Pixel Size = FOV / Matrix. 300 / 1024 ≈ 0.29 mm." },
    { id: 14, q: "The phenomenon where X-ray photons are produced 180-degrees from the focal spot (off-focus) is called:", options: ["Stem radiation", "Extra-focal radiation", "Leakage", "Scatter"], correct: 1, explanation: "Extra-focal or off-focus radiation creates a 'ghosting' appearance outside the collimated margins." },
    { id: 15, q: "Which interaction is the primary source of occupational exposure to the radiographer?", options: ["Photoelectric", "Compton Scatter", "Coherent", "Photodisintegration"], correct: 1, explanation: "Compton scatter from the patient is the main source of dose to staff." },

    // --- DIGITAL RADIOGRAPHY & INFORMATICS ---
    { id: 16, q: "In CR, the 'F-centers' (electron traps) are created by adding impurities of:", options: ["Europium", "Lead", "Tungsten", "Cesium"], correct: 0, explanation: "Europium is the activator added to Barium Fluorohalide crystals to create the metastable electron traps." },
    { id: 17, q: "The 'Fill Factor' in a TFT (Thin Film Transistor) array refers to:", options: ["Percentage of pixel area sensitive to X-rays", "Storage capacity", "Speed of readout", "Thickness of the scintillator"], correct: 0, explanation: "A higher fill factor means more of the pixel area is used for sensing, resulting in higher efficiency." },
    { id: 18, q: "The 'Nyquist Frequency' determines the:", options: ["Maximum spatial resolution", "Maximum contrast", "Bit depth", "Exposure index"], correct: 0, explanation: "Nyquist frequency is 1/(2 x pixel pitch). It sets the limit for the highest spatial frequency the system can resolve." },
    { id: 19, q: "Which histogram analysis error occurs when the collimated borders are not recognized?", options: ["Histogram Analysis Error", "Moiré Pattern", "Aliasing", "Scaling Error"], correct: 0, explanation: "If collimation is not detected, the software includes raw radiation in the calculation, causing the image to look too dark or light (rescaling error)." },
    { id: 20, q: "The standard HL7 is primarily used for:", options: ["Image data transfer", "Text-based medical information exchange", "Monitor calibration", "3D reconstruction"], correct: 1, explanation: "DICOM is for images; HL7 (Health Level 7) is for textual data like patient registration and reports." },
    { id: 21, q: "A 'Look-Up Table' (LUT) is used to:", options: ["Map raw pixel values to desired brightness/contrast", "Store patient data", "Measure dose", "Focus the beam"], correct: 0, explanation: "The LUT applies a non-linear transformation to raw data to give the image the correct contrast characteristics." },
    { id: 22, q: "Which RAID level uses 'block-level striping with distributed parity'?", options: ["RAID 0", "RAID 1", "RAID 5", "RAID 10"], correct: 2, explanation: "RAID 5 is commonly used in PACS servers for a balance of speed, redundancy, and storage efficiency." },

    // --- CT PHYSICS & INSTRUMENTATION ---
    { id: 23, q: "The 'Bow-Tie' filter in CT is used to:", options: ["Equalize radiation flux across the patient", "Remove low energy photons only", "Focus the beam", "Reduce ring artifacts"], correct: 0, explanation: "It makes the beam intensity consistent across the circular cross-section of the patient, reducing surface dose." },
    { id: 24, q: "In Multidetector CT (MDCT), 'Geometric Efficiency' is reduced due to:", options: ["Interspace material between detectors (Dead space)", "High kVp", "Slow rotation", "Afterglow"], correct: 0, explanation: "The separators between detector elements absorb radiation but do not contribute to the signal (Dead Space)." },
    { id: 25, q: "Third Generation CT scanners introduced:", options: ["Pencil beam", "Translate-Rotate", "Rotate-Rotate (Fan beam)", "Stationary Detectors"], correct: 2, explanation: "3rd Gen uses a rotating tube and rotating detector array with a fan beam." },
    { id: 26, q: "Which Reconstruction Algorithm is preferred for reducing metal artifacts?", options: ["Filtered Back Projection", "Iterative Reconstruction", "Fourier Transform", "Maximum Intensity Projection"], correct: 1, explanation: "Iterative Reconstruction (IR) can statistically model and correct for photon starvation and beam hardening caused by metal." },
    { id: 27, q: "CTDI-vol is calculated as:", options: ["CTDIw / Pitch", "CTDIw * Pitch", "DLP / Scan Length", "CTDI-100 / Pitch"], correct: 0, explanation: "CTDI-vol accounts for the helical pitch. CTDI-vol = Weighted CTDI / Pitch." },
    { id: 28, q: "Streak artifacts between two dense objects in CT are primarily caused by:", options: ["Photon Starvation / Beam Hardening", "Patient Motion", "Ring Artifact", "Cone beam effect"], correct: 0, explanation: "The beam is excessively hardened or attenuated between two dense objects (e.g., hips), causing dark streaks." },
    { id: 29, q: "The 'Afterglow' characteristic of a CT scintillator should be:", options: ["Long", "Short (<1ms)", "Variable", "High"], correct: 1, explanation: "Short afterglow is crucial for fast CT scanning to prevent 'ghosting' or blurring between views." },
    { id: 30, q: "Which kernel/filter should be used for temporal bone or lung imaging?", options: ["Smoothing / Soft", "Standard", "Edge-enhancing / Sharp / Bone", "Average"], correct: 2, explanation: "High spatial frequency algorithms (Bone/Sharp) are needed for high-detail structures like lungs and inner ear." },

    // --- MRI PHYSICS ---
    { id: 31, q: "The Gyromagnetic Ratio for Hydrogen (1H) is approximately:", options: ["42.58 MHz/Tesla", "63.8 MHz/Tesla", "21.2 MHz/Tesla", "100 MHz/Tesla"], correct: 0, explanation: "This is the constant used in the Larmor Equation (42.58 MHz/T)." },
    { id: 32, q: "At 1.5 Tesla, the Larmor frequency of Hydrogen is:", options: ["21 MHz", "42 MHz", "63.86 MHz", "127 MHz"], correct: 2, explanation: "42.58 MHz/T * 1.5 T ≈ 63.86 MHz." },
    { id: 33, q: "The 'Chemical Shift' artifact occurs because:", options: ["Fat and Water protons precess at slightly different frequencies", "Patient motion", "Gradient failure", "Radiofrequency interference"], correct: 0, explanation: "There is a ~3.5 ppm frequency difference between fat and water, causing spatial misregistration in the frequency-encoding direction." },
    { id: 34, q: "In Spin Echo, the 180-degree pulse is used to:", options: ["Flip the net magnetization", "Refocus dephasing spins", "Saturate fat", "Excite the slice"], correct: 1, explanation: "The 180-degree pulse rephases the spins to create the 'Echo'." },
    { id: 35, q: "Short TI Inversion Recovery (STIR) is used to:", options: ["Suppress Fat signal", "Suppress Fluid signal", "Enhance Flow", "Improve Resolution"], correct: 0, explanation: "STIR uses an inversion time (TI) chosen to null the signal from fat." },
    { id: 36, q: "The FDA limit for Specific Absorption Rate (SAR) for the whole body is:", options: ["2 W/kg", "4 W/kg (15 min)", "8 W/kg", "10 W/kg"], correct: 1, explanation: "The limit is 4 W/kg averaged over 15 minutes to prevent patient heating." },
    { id: 37, q: "Which gradient determines the Slice Thickness?", options: ["Slice Select Gradient", "Frequency Encoding Gradient", "Phase Encoding Gradient", "Shim Gradient"], correct: 0, explanation: "The Slice Select Gradient (z-gradient for axial) coupled with RF bandwidth determines thickness." },
    { id: 38, q: "Filling the center of K-Space provides information about:", options: ["Image Contrast", "Image Resolution", "Edges", "Noise"], correct: 0, explanation: "Center of K-space = Signal/Contrast; Periphery of K-space = Detail/Resolution." },
    { id: 39, q: "Aliasing (Wrap-around) artifact occurs when:", options: ["FOV is smaller than the anatomy", "FOV is larger than anatomy", "TR is too short", "TE is too long"], correct: 0, explanation: "Anatomy outside the FOV is undersampled and wraps to the opposite side." },
    { id: 40, q: "FLAIR (Fluid Attenuated Inversion Recovery) sequences typically use a _____ TE and _____ TR.", options: ["Short TE, Short TR", "Long TE, Long TR", "Short TE, Long TR", "Long TE, Short TR"], correct: 1, explanation: "FLAIR is T2-weighted (Long TE/TR) but uses an Inversion Pulse to suppress CSF." },

    // --- RADIATION SAFETY & BIOLOGY ---
    { id: 41, q: "The ICRP annual equivalent dose limit for the 'Lens of the Eye' for radiation workers is:", options: ["150 mSv", "20 mSv", "50 mSv", "500 mSv"], correct: 1, explanation: "It was reduced from 150 mSv to 20 mSv/year (avg over 5 years) due to increased cataract risk sensitivity." },
    { id: 42, q: "Which blood cells are the most radiosensitive?", options: ["Erythrocytes", "Lymphocytes", "Platelets", "Granulocytes"], correct: 1, explanation: "Lymphocytes are the most sensitive blood cells and drop rapidly after exposure." },
    { id: 43, q: "The 'Doubling Dose' for humans (genetic mutations) is estimated to be:", options: ["0.01 Gy", "1.5 - 2.0 Gy", "10 Gy", "100 Gy"], correct: 1, explanation: "The dose required to double the spontaneous mutation rate is approx 1.5 - 2.0 Sv (Gy)." },
    { id: 44, q: "For a 'Controlled Area', the shielding must reduce exposure to less than:", options: ["20 mSv/yr", "1 mSv/yr", "0.1 mSv/week", "10 mSv/week"], correct: 2, explanation: "Controlled areas are shielded to keep exposure < 0.1 mSv/week (approx 5 mSv/yr)." },
    { id: 45, q: "What is the 'Genetically Significant Dose' (GSD)?", options: ["Dose that causes sterility", "Average gonadal dose to the population", "Dose to the fetus", "Dose causing cancer"], correct: 1, explanation: "GSD is an index of the radiation received by the genetic pool of the population." },
    { id: 46, q: "Which syndrome of Acute Radiation Syndrome (ARS) occurs at doses > 50 Gy?", options: ["Hematopoietic", "Gastrointestinal", "CNS / Cerebrovascular", "Cutaneous"], correct: 2, explanation: "CNS syndrome occurs at very high doses (>50 Gy) leading to death within hours/days." },
    { id: 47, q: "Which dosimetry device uses 'Aluminum Oxide (Al2O3:C)'?", options: ["TLD", "OSL (Optically Stimulated Luminescence)", "Film Badge", "Pocket Chamber"], correct: 1, explanation: "OSL dosimeters (like Luxel) use Aluminum Oxide detectors stimulated by laser." },
    { id: 48, q: "The 'Ten Day Rule' implies X-ray exams of the pelvis should be done:", options: ["During the first 10 days of the menstrual cycle", "10 days after ovulation", "10 days before menstruation", "Any time"], correct: 0, explanation: "This minimizes the risk of irradiating an unsuspected pregnancy (ovulation occurs ~day 14)." },
    { id: 49, q: "According to AERB, the leakage radiation from the tube housing must not exceed:", options: ["1 mGy/hr at 1 meter", "10 mGy/hr at 1 meter", "0.1 mGy/hr at 1 meter", "5 mGy/hr at 1 meter"], correct: 0, explanation: "1 mGy/hr (100 mR/hr) at 1 meter from the focus at max rating." },
    { id: 50, q: "Which calculation is used to determine barrier thickness?", options: ["W x U x T", "kVp x mAs", "Inverse Square", "HVL x 10"], correct: 0, explanation: "Workload (W) x Use Factor (U) x Occupancy Factor (T) is used in shielding calculations." },

    // --- RADIOGRAPHIC POSITIONING & ANATOMY (ADVANCED) ---
    { id: 51, q: "The 'Judet View' (Internal Oblique) of the acetabulum demonstrates the:", options: ["Anterior Column and Posterior Rim", "Posterior Column and Anterior Rim", "Ilioischial line", "Sacroiliac joint"], correct: 1, explanation: "Internal (Obturator) Oblique shows Posterior Column & Anterior Rim. External (Iliac) shows Anterior Column & Posterior Rim." },
    { id: 52, q: "For the 'Zanca View' (AC Joints), the tube is angled:", options: ["10-15 degrees Cephalad", "30 degrees Caudal", "Perpendicular", "45 degrees Cephalad"], correct: 0, explanation: "10-15 degree cephalic angle projects the AC joint superior to the acromion." },
    { id: 53, q: "Which view demonstrates the 'Hill-Sachs' defect?", options: ["Stryker Notch View", "Axial View", "Transcapular Y", "Grashey View"], correct: 0, explanation: "Stryker Notch view is specific for the posterolateral humeral head defect (Hill-Sachs)." },
    { id: 54, q: "The 'Grashey Method' is used to visualize:", options: ["Glenohumeral joint space (True AP)", "Scapular spine", "Coracoid process", "Bicipital groove"], correct: 0, explanation: "Patient rotated 35-45 degrees to place the scapula parallel to the IR, opening the joint space." },
    { id: 55, q: "In the 'Rhese Method', the anatomical structure of interest is:", options: ["Optic Foramen", "Auditory Ossicles", "Sella Turcica", "Jugular Foramen"], correct: 0, explanation: "Parieto-orbital oblique projection to visualize the optic foramen in the lower outer quadrant." },
    { id: 56, q: "For a Lateral projection of the Sacrum, the CR should be directed:", options: ["Perpendicular to the level of ASIS", "3.5 inches posterior to ASIS", "2 inches anterior to posterior surface of sacrum", "Perpendicular to the iliac crest"], correct: 1, explanation: "CR is perpendicular to the level of ASIS and 3.5 inches (8-10cm) posterior to it." },
    { id: 57, q: "The 'Inlet View' of the pelvis requires a tube angulation of:", options: ["40 degrees Caudal", "40 degrees Cephalad", "25 degrees Cephalad", "Perpendicular"], correct: 0, explanation: "Inlet view = 40 deg Caudal. Outlet (Taylor) = 20-40 deg Cephalad." },
    { id: 58, q: "Which structure forms the 'Nose' of the Scottie Dog?", options: ["Transverse Process", "Pedicle", "Superior Articular Process", "Pars Interarticularis"], correct: 0, explanation: "Nose = Transverse Process. Eye = Pedicle. Neck = Pars. Ear = Superior Articular Process. Leg = Inferior Articular Process." },
    { id: 59, q: "The 'Camp Coventry' method for the Knee Intercondylar Fossa requires:", options: ["Patient prone, knee flexed 40-50 deg, Caudal angle", "Patient supine, knee flexed 40 deg", "Patient standing", "Knee extended"], correct: 0, explanation: "Prone tunnel view. CR matches flexion angle (40-50 deg caudal)." },
    { id: 60, q: "Where does the Central Ray enter for a SMV (Submentovertex) projection of the Zygomatic Arches?", options: ["Midway between zygomatic arches, at level 1 inch posterior to outer canthi", "Glabella", "Vertex", "Mental Point"], correct: 0, explanation: "It enters the throat and passes midway between arches." },
    { id: 61, q: "The 'Fuch's Method' (AP) is used to visualize:", options: ["Dens (Odontoid) within Foramen Magnum", "C7-T1", "Mandibular rami", "Temporal bone"], correct: 0, explanation: "Used when the odontoid is not seen in the open mouth view." },
    { id: 62, q: "For the 'Haas Method' (PA Axial Skull), the tube angulation is:", options: ["25 degrees Cephalad", "30 degrees Cephalad", "30 degrees Caudal", "Perpendicular"], correct: 0, explanation: "It is a reverse Towne method. 25 deg Cephalad." },
    { id: 63, q: "To demonstrate the 'Pars Interarticularis' of the Lumbar spine, the patient is rotated:", options: ["45 degrees", "30 degrees", "70 degrees", "20 degrees"], correct: 0, explanation: "45-degree oblique is standard for Lumbar pars. (Note: 70 deg for Thoracic zygapophyseal)." },
    { id: 64, q: "The 'Laurin View' (Tangential) is for:", options: ["Patella", "Calcaneus", "Elbow", "Skull"], correct: 0, explanation: "Inferosuperior projection for the patella." },
    { id: 65, q: "Which baseline is perpendicular to the IR for a standard Lateral Skull?", options: ["Interpupillary Line (IPL)", "Orbitomeatal Line (OML)", "Infraorbitomeatal Line (IOML)", "Acanthiomeatal Line (AML)"], correct: 0, explanation: "For a true lateral, the IPL must be perpendicular to the IR." },

    // --- CONTRAST & SPECIAL PROCEDURES ---
    { id: 66, q: "The osmolality of Non-Ionic contrast media (LOCM) is roughly:", options: ["600-800 mOsm/kg", "2000 mOsm/kg", "290 mOsm/kg", "100 mOsm/kg"], correct: 0, explanation: "Blood is ~290 mOsm/kg. HOCM is ~1500-2000. LOCM is ~600-800 (still hyperosmolar but less so). Iso-osmolar is ~290." },
    { id: 67, q: "Viscosity of contrast media can be reduced by:", options: ["Heating to body temperature", "Cooling", "Mixing with saline", "Shaking"], correct: 0, explanation: "Warming contrast to 37°C significantly reduces viscosity, making injection easier." },
    { id: 68, q: "Which catheter curve is designed for the Right Coronary Artery?", options: ["Judkins Right (JR4)", "Judkins Left (JL4)", "Pigtail", "Simmons"], correct: 0, explanation: "JR (Judkins Right) is for the RCA." },
    { id: 69, q: "In HSG, contrast spillage into the peritoneal cavity indicates:", options: ["Patent fallopian tubes", "Blocked tubes", "Uterine perforation", "Infection"], correct: 0, explanation: "Free spill is the positive sign of tubal patency." },
    { id: 70, q: "The 'Seldinger Technique' involves puncture of the:", options: ["Artery/Vein with a hollow needle, then guidewire insertion", "Skin only", "Muscle", "Nerve"], correct: 0, explanation: "Needle -> Guidewire -> Remove Needle -> Dilator/Catheter over wire." },
    { id: 71, q: "What is the standard needle gauge for an adult femoral artery puncture?", options: ["18G", "24G", "14G", "30G"], correct: 0, explanation: "18 Gauge is the standard size for accepting 0.035 or 0.038 inch guidewires." },
    { id: 72, q: "Contrast Induced Nephropathy (CIN) risk is reduced by:", options: ["Hydration (Pre and Post)", "Giving Diuretics", "High osmolar contrast", "Fast injection"], correct: 0, explanation: "Hydration helps flush the kidneys and dilute the contrast." },
    { id: 73, q: "For a 'T-Tube Cholangiogram', contrast is injected into:", options: ["T-tube placed in Common Bile Duct", "Gallbladder", "Liver parenchyma", "Duodenum"], correct: 0, explanation: "Performed post-cholecystectomy to check for residual stones." },
    { id: 74, q: "The 'Valsalva Maneuver' is used during:", options: ["Esophagogram (to check for varices)", "IVU", "Arthrogram", "HSG"], correct: 0, explanation: "Increasing intra-abdominal pressure helps demonstrate esophageal varices." },
    { id: 75, q: "In Digital Subtraction Angiography (DSA), the 'Mask' image is:", options: ["The pre-contrast image", "The peak contrast image", "The subtracted image", "The roadmapping image"], correct: 0, explanation: "The mask is the image taken before contrast arrives, which is digitally subtracted from the live contrast image." },

    // --- ULTRASOUND & QA/QC ---
    { id: 76, q: "The speed of sound in soft tissue is assumed to be:", options: ["1540 m/s", "330 m/s", "4080 m/s", "1000 m/s"], correct: 0, explanation: "This is the average velocity used for calibration in USG machines." },
    { id: 77, q: "The 'Doppler Shift' is greatest when the angle between the beam and flow is:", options: ["0 degrees", "90 degrees", "60 degrees", "45 degrees"], correct: 0, explanation: "Cosine of 0 is 1 (Max shift). Cosine of 90 is 0 (No shift)." },
    { id: 78, q: "Which resolution is determined by 'Pulse Length'?", options: ["Axial Resolution", "Lateral Resolution", "Elevational Resolution", "Temporal Resolution"], correct: 0, explanation: "Shorter pulses provide better Axial resolution (along the beam path)." },
    { id: 79, q: "QA: Linearity of mA stations should be within:", options: ["± 10%", "± 2%", "± 5%", "± 20%"], correct: 0, explanation: "Linearity (mR/mAs constancy across stations) implies a limit of ± 10%." },
    { id: 80, q: "QA: Reproducibility of exposure (same technique repeated) should be within:", options: ["± 5%", "± 10%", "± 2%", "± 15%"], correct: 0, explanation: "Coefficient of variation should not exceed 0.05 (5%)." },

    // --- PATHOLOGY & TRAUMA ---
    { id: 81, q: "A 'Boxer's Fracture' involves the:", options: ["Neck of 5th Metacarpal", "Distal Radius", "Navicular", "Thumb base"], correct: 0, explanation: "Fracture of the 5th metacarpal neck, usually from punching." },
    { id: 82, q: "The 'Bamboo Spine' appearance is characteristic of:", options: ["Ankylosing Spondylitis", "Osteoporosis", "Multiple Myeloma", "Scoliosis"], correct: 0, explanation: "Calcification of the longitudinal ligaments gives the bamboo appearance." },
    { id: 83, q: "'Sail Sign' (elevated fat pad) in an elbow X-ray indicates:", options: ["Occult fracture (Radial head)", "Dislocation", "Bursitis", "Normal variant"], correct: 0, explanation: "Displacement of the fat pad suggests joint effusion caused by a fracture." },
    { id: 84, q: "'Apple Core' lesion in Barium Enema is indicative of:", options: ["Colon Cancer (Annular)", "Diverticulitis", "Polyp", "Volvulus"], correct: 0, explanation: "Constricting carcinoma of the colon resembles an apple core." },
    { id: 85, q: "'Cotton Wool' spots in skull X-ray are seen in:", options: ["Paget's Disease", "Multiple Myeloma", "Metastasis", "Rickets"], correct: 0, explanation: "Paget's disease (osteitis deformans) presents with mixed lytic and sclerotic areas." },
    { id: 86, q: "The 'Silhouette Sign' in chest X-ray refers to:", options: ["Loss of a normal border due to adjacent pathology", "Air bronchogram", "Lung collapse", "Pleural effusion level"], correct: 0, explanation: "Loss of the heart or diaphragm border indicates pathology (like pneumonia) in the adjacent lung lobe." },
    { id: 87, q: "Which view is best for detecting a small Pneumothorax?", options: ["PA Expiration", "PA Inspiration", "Lateral", "Lordotic"], correct: 0, explanation: "Expiration reduces lung volume, making the pneumothorax air relatively larger and denser contrast." },
    { id: 88, q: "A 'Hangman's Fracture' involves the:", options: ["Pedicles of C2 (Axis)", "Odontoid process", "C1 (Atlas)", "C7 spinous process"], correct: 0, explanation: "Traumatic spondylolisthesis of C2 due to hyperextension." },
    { id: 89, q: "Jefferson Fracture is a burst fracture of:", options: ["C1 (Atlas)", "C2", "T12", "L1"], correct: 0, explanation: "Burst fracture of the ring of Atlas." },
    { id: 90, q: "Monteggia Fracture-Dislocation involves:", options: ["Proximal Ulnar fracture with Radial Head dislocation", "Distal Radius fracture", "Radial shaft fracture with Ulnar dislocation", "Humeral fracture"], correct: 0, explanation: "Ulnar fracture + Radial head dislocation. (Galeazzi is Radius fracture + Ulnar dislocation)." },

    // --- MIXED BAG / ADVANCED ---
    { id: 91, q: "The 'Sensitivity Speck' in film emulsion (Sliver Halide) is usually:", options: ["Silver Sulfide", "Gold", "Lead", "Bromide"], correct: 0, explanation: "Silver Sulfide acts as the electron trap to initiate the latent image center." },
    { id: 92, q: "What is the 'HVL' (Half Value Layer) requirement at 80 kVp?", options: ["2.3 - 2.5 mm Al", "1.0 mm Al", "4.0 mm Al", "0.5 mm Al"], correct: 0, explanation: "Typically ~2.3 to 2.5 mm Al is the required beam quality at 80 kVp." },
    { id: 93, q: "In Mammography, the compression force applied is typically:", options: ["100-200 Newtons (approx 10-20kg)", "50 Newtons", "300 Newtons", "500 Newtons"], correct: 0, explanation: "Sufficient to reduce thickness and motion, usually 11-20 daN." },
    { id: 94, q: "Which scintillator is used in indirect flat panel detectors?", options: ["Cesium Iodide (CsI) or Gadolinium Oxysulfide", "Amorphous Selenium", "CCD", "CMOS"], correct: 0, explanation: "These phosphors convert X-rays to light." },
    { id: 95, q: "The 'Field size' of an Image Intensifier mode refers to the:", options: ["Diameter of the Input Phosphor used", "Output phosphor size", "Monitor size", "Collimator setting"], correct: 0, explanation: "e.g., 25cm mode uses 25cm of the input phosphor. Mag mode (15cm) uses only the center 15cm." },
    { id: 96, q: "Flux Gain x Minification Gain equals:", options: ["Brightness Gain", "Conversion Factor", "DQE", "MTF"], correct: 0, explanation: "Total Brightness Gain = Flux Gain x Minification Gain." },
    { id: 97, q: "Which post-processing technique improves visibility of small, high-contrast structures (tubes/lines)?", options: ["Edge Enhancement / High-pass filtering", "Smoothing / Low-pass filtering", "Inversion", "Subtraction"], correct: 0, explanation: "Edge enhancement increases the contrast at boundaries." },
    { id: 98, q: "The 'Reciprocity Law' fails when exposure times are:", options: ["Extremely short or extremely long", "Normal range", "Using screens", "Using high kVp"], correct: 0, explanation: "Reciprocity law failure occurs at extremely short (<1ms) or long exposures (mostly film physics)." },
    { id: 99, q: "Ideally, the Focal Spot Size for Magnification Mammography should be:", options: ["0.1 mm", "0.3 mm", "0.6 mm", "1.0 mm"], correct: 0, explanation: "0.1 mm is required to maintain resolution despite geometric unsharpness from magnification." },
    { id: 100, q: "For a 'Scoliosis Series' (Ferguson method), the second view is taken with:", options: ["The convex side of the curve elevated (on a block)", "Patient bending", "Patient prone", "Lateral"], correct: 0, explanation: "Placing a block under the convex side helps distinguish structural vs non-structural curves." }
];

let userAnswers = JSON.parse(localStorage.getItem('aiims_paper4_answers')) || {};
let submitted = false;
let reviewMode = false;

const quizContainer = document.getElementById('quiz-container');
const attemptCountSpan = document.getElementById('attempt-count');

function renderQuiz(){
  quizContainer.innerHTML = '';

  questionsDB.forEach((q, i)=>{
    const card = document.createElement('div');
    card.className = 'question-card';

    card.innerHTML = `<div class="question-text">Q${i+1}. ${q.q}</div>`;
    const optDiv = document.createElement('div');
    optDiv.className = 'options-grid';

    const ua = userAnswers[q.id];

    q.options.forEach((opt, idx)=>{
      const label = document.createElement('label');
      label.className = 'option-label';

      if(!reviewMode && ua === idx) label.classList.add('selected');
      if(reviewMode){
        if(idx === q.correct) label.classList.add('correct');
        if(ua === idx && ua !== q.correct) label.classList.add('wrong');
      }

      label.innerHTML = `
        <input type="radio" ${ua===idx?'checked':''} ${submitted?'disabled':''}>
        <span>${opt}</span>
      `;

      if(!submitted){
        label.onclick = ()=>{
          userAnswers[q.id] = idx;
          localStorage.setItem('aiims_paper4_answers', JSON.stringify(userAnswers));
          renderQuiz();
        };
      }

      optDiv.appendChild(label);
    });

    card.appendChild(optDiv);

    if(reviewMode){
      const exp = document.createElement('div');
      exp.className = 'explanation';
      exp.innerHTML = `<b>Explanation:</b> ${q.explanation}`;
      card.appendChild(exp);
    }

    quizContainer.appendChild(card);
  });

  attemptCountSpan.innerText = Object.keys(userAnswers).length;
}

function submitExam(){
  if(submitted) return;
  if(!confirm("Submit Paper 4?")) return;

  submitted = true;

  let c=0,w=0,s=0;
  questionsDB.forEach(q=>{
    const a = userAnswers[q.id];
    if(a==null) s++;
    else if(a===q.correct) c++;
    else w++;
  });

  document.getElementById('final-score').innerText = c*4 - w;
  document.getElementById('count-correct').innerText = c;
  document.getElementById('count-wrong').innerText = w;
  document.getElementById('count-skipped').innerText = s;
  document.getElementById('accuracy').innerText =
    (c/(c+w||1)*100).toFixed(0);

  document.getElementById('result-modal').style.display='flex';
  renderQuiz();
}

function startReview(){
  document.getElementById('result-modal').style.display='none';
  reviewMode = true;
  renderQuiz();
  window.scrollTo({top:0,behavior:'smooth'});
}

function resetExam(){
  if(!confirm("Reset Paper 4?")) return;
  localStorage.removeItem('aiims_paper4_answers');
  location.reload();
}

renderQuiz();
</script>
</body>
</html>
